<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Construction Volunteer Management123</title>
    <!-- Tailwind CSS CDN for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SheetJS (xlsx) library for Excel file parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- Chart.js for charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<!-- Fixed Navbar Header -->
<header class="fixed top-0 left-0 w-full bg-white shadow z-50">
  <div class="max-w-screen-2xl mx-auto px-4 py-4 flex justify-between items-center">
    <h1 class="text-2xl md:text-3xl font-bold text-blue-800">
      Construction Volunteer Management System
    </h1>

    <a href="passcode.html" class="flex items-center space-x-2 text-red-600 hover:text-red-800 transition" title="Logout">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
        <path fill-rule="evenodd" d="M3 10a1 1 0 011-1h9.586l-3.293-3.293a1 1 0 111.414-1.414l5 5a1 1 0 010 1.414l-5 5a1 1 0 11-1.414-1.414L13.586 11H4a1 1 0 01-1-1z" clip-rule="evenodd" />
      </svg>
      <span class="text-sm font-medium">Logout</span>
    </a>
  </div>
</header>




    <div class="container max-w-screen-2xl pt-20 px-4 mx-auto">
       
        <!-- Tab Navigation -->
        <div class="flex justify-center flex-wrap gap-2 mb-8">
            <button class="tab-button active" data-tab="volunteers">Volunteer Management</button>
            <button class="tab-button" data-tab="attendance">Attendance Monitoring</button>
            <button class="tab-button" data-tab="tasks">Task & Assignment</button>
            <button class="tab-button" data-tab="requests">Request Management</button>
            <button class="tab-button" data-tab="tradeReports">Trade Reports</button>
        </div>

        <!-- Volunteer Management Tab -->
        <div id="volunteers" class="tab-content active">
            <h2 class="text-3xl font-semibold mb-6 text-gray-700">Volunteer Information</h2>

            <!-- Button to show the volunteer form -->
            <div class="mb-6 text-center space-x-4">
                <button id="addNewVolunteerBtn" class="btn-primary">Add New Volunteer</button>
                <button id="importExcelBtn" class="btn-secondary">Import from Excel</button>
                <input type="file" id="excelFileInput" class="hidden" accept=".xlsx, .xls, .csv">
            </div>

            <!-- Volunteer Form - Initially hidden -->
            <div id="volunteerFormContainer" class="hidden">
                <form id="volunteerForm" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 p-6 bg-blue-50 rounded-lg shadow-inner">
                    <input type="hidden" id="volunteerId">
                    <div class="form-group md:col-span-2">
                        <label for="fullName">Full Name:</label>
                        <input type="text" id="fullName" required class="mt-1" placeholder="e.g., Dela Cruz, Juan A.">
                    </div>
                    <div class="form-group">
                        <label for="assignedNumber">Assigned Number:</label>
                        <input type="text" id="assignedNumber" required class="mt-1">
                    </div>
                     <div class="form-group">
                        <label for="contactNumber">Contact Number:</label>
                        <input type="tel" id="contactNumber" class="mt-1">
                    </div>
                    <div class="form-group">
                        <label for="trade">Trade:</label>
                        <select id="trade" class="mt-1" required>
                            <option value="">-- Select Trade --</option>
                            <option value="Bodegero">Bodegero</option>
                            <option value="Carpenter">Carpenter</option>
                            <option value="Driver">Driver</option>
                            <option value="Electrician">Electrician</option>
                            <option value="Foreman">Foreman</option>
                            <option value="Gardener">Gardener</option>
                            <option value="Heavy Equipment Operator">Heavy Equipment Operator</option>
                            <option value="HVAC Technician">HVAC Technician</option>
                            <option value="Ironworker">Ironworker</option>
                            <option value="Laborer">Laborer</option>
                            <option value="Mason">Mason</option>
                            <option value="Painter">Painter</option>
                            <option value="Plumber">Plumber</option>
                            <option value="Roofer">Roofer</option>
                            <option value="Steelman">Steelman</option>
                            <option value="Tinsmith">Tinsmith</option>
                            <option value="Upholsterer">Upholsterer</option>
                            <option value="Welder">Welder</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="maritalStatus">Marital Status:</label>
                        <select id="maritalStatus" class="mt-1" required>
                            <option value="">-- Select Status --</option>
                            <option value="Single">Single</option>
                            <option value="Married">Married</option>
                            <option value="Widower">Widower</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="homeAddress">Home Address:</label>
                        <input type="text" id="homeAddress" class="mt-1">
                    </div>
                    <div class="form-group">
                        <label for="birthDate">Birth Date:</label>
                        <input type="date" id="birthDate" class="mt-1">
                        <span id="volunteerAge" class="text-sm text-gray-600 ml-2"></span> <!-- Display for age -->
                    </div>
                    <div class="form-group">
                        <label for="bloodType">Blood Type:</label>
                        <select id="bloodType" class="mt-1">
                            <option value="">-- Select Blood Type --</option>
                            <option value="A+">A+</option>
                            <option value="A-">A-</option>
                            <option value="B+">B+</option>
                            <option value="B-">B-</option>
                            <option value="AB+">AB+</option>
                            <option value="AB-">AB-</option>
                            <option value="O+">O+</option>
                            <option value="O-">O-</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="medicalCondition">Medical Condition(s):</label>
                        <input type="text" id="medicalCondition" class="mt-1" placeholder="e.g., Asthma, Diabetes">
                    </div>
                    <div class="form-group">
                        <label for="emergencyContactPerson">Emergency Contact Person:</label>
                        <input type="text" id="emergencyContactPerson" class="mt-1">
                    </div>
                    <div class="form-group">
                        <label for="emergencyContactNumber">Emergency Contact Number:</label>
                        <input type="tel" id="emergencyContactNumber" class="mt-1">
                    </div>
                    <div class="form-group">
                        <label for="spouseName">Spouse Name:</label>
                        <input type="text" id="spouseName" class="mt-1">
                    </div>
                     <div class="form-group">
                        <label for="spouseContactNumber">Spouse's Contact Number:</label>
                        <input type="tel" id="spouseContactNumber" class="mt-1">
                    </div>
                    <div class="form-group">
                        <label for="weddingAnniversary">Wedding Anniversary:</label>
                        <input type="date" id="weddingAnniversary" class="mt-1">
                    </div>
                    <div class="form-group">
                        <label for="churchCongregation">Church Local Congregation:</label>
                        <input type="text" id="churchCongregation" class="mt-1">
                    </div>

                    <!-- Children's Information -->
                    <div class="md:col-span-2" id="childrenSection" data-marital-status-dependent>
                        <h4 class="text-lg font-semibold mb-2 text-gray-700">Children's Information</h4>
                        <div id="childrenInfoContainer" class="space-y-3">
                            <!-- Child input rows will be added here by JavaScript -->
                        </div>
                        <button type="button" id="addChildBtn" class="btn-secondary mt-3 px-4 py-2 text-sm">Add Child</button>
                    </div>

                    <!-- Volunteer Picture Upload -->
                    <div class="md:col-span-2">
                        <h4 class="text-lg font-semibold mb-2 text-gray-700">Volunteer Picture</h4>
                        <div id="pictureDropArea" class="drop-area">
                            Drag & Drop Picture Here or Paste (Ctrl+V)
                            <input type="file" id="pictureUploadInput" accept="image/*" class="hidden">
                            <img id="picturePreview" class="image-preview mx-auto" src="#" alt="Image Preview" style="display: none;">
                        </div>
                        <button type="button" id="clearPictureBtn" class="btn-secondary mt-3 px-4 py-2 text-sm">Clear Picture</button>
                    </div>


                    <div class="md:col-span-2 flex justify-end space-x-4">
                        <button type="submit" class="btn-primary">Save Volunteer</button>
                        <button type="button" id="clearVolunteerForm" class="btn-secondary">Clear Form</button>
                    </div>
                </form>
            </div>

            <!-- Registered Volunteers - Card View -->
            <div id="volunteerCardView">
                <h3 class="text-2xl font-semibold mb-4 text-gray-700">Registered Volunteers</h3>
                <div class="mb-4 flex flex-wrap items-center gap-4">
                    <div class="flex-grow flex items-center space-x-2">
                         <label for="volunteerSearch" class="font-medium text-gray-700">Search:</label>
                         <input type="text" id="volunteerSearch" placeholder="Name or assigned number..." class="flex-1 p-2 border rounded-md">
                         <button id="clearSearchBtn" class="btn-secondary px-3 py-2 text-sm">Clear</button>
                    </div>
                    <div class="flex items-center space-x-2">
                        <label for="sortVolunteersBy" class="font-medium text-gray-700">Sort By:</label>
                        <select id="sortVolunteersBy" class="p-2 border rounded-md">
                            <option value="fullName">Full Name</option>
                            <option value="age">Age</option>
                            <option value="trade">Trade</option>
                            <option value="churchCongregation">Church Congregation</option>
                        </select>
                    </div>
                </div>
                <div id="volunteerCardList" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <!-- Volunteer cards will be loaded here -->
                </div>
                <p id="noVolunteersFound" class="text-center text-gray-600 mt-8 hidden">No volunteers found matching your search.</p>
                <p id="noRegisteredVolunteers" class="text-center text-gray-600 mt-8 hidden">No volunteers registered yet.</p>
            </div>

            <!-- Volunteer Detail View - Initially hidden -->
            <div id="volunteerDetailView" class="hidden volunteer-detail-view">
                <button id="backToVolunteerListBtn" class="btn-secondary mb-6">← Back to Volunteer List</button>
                <div class="flex flex-col items-center">
                    <img id="detailPicture" class="detail-picture" src="#" alt="Volunteer Picture">
                    <h3 id="detailFullName" class="text-center"></h3>
                    <p id="detailAssignedNumber" class="text-lg text-gray-600 mb-4"></p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6 text-left">
                    <div class="detail-group"><span class="detail-label">Trade:</span> <span id="detailTrade" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Age:</span> <span id="detailAge" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Contact Number:</span> <span id="detailContactNumber" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Blood Type:</span> <span id="detailBloodType" class="detail-value"></span></div>
                    <div class="detail-group md:col-span-2"><span class="detail-label">Medical Condition(s):</span> <span id="detailMedicalCondition" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Emergency Contact:</span> <span id="detailEmergencyContactPerson" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Emergency Contact No.:</span> <span id="detailEmergencyContactNumber" class="detail-value"></span></div>
                    <div class="detail-group md:col-span-2"><span class="detail-label">Home Address:</span> <span id="detailHomeAddress" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Birth Date:</span> <span id="detailBirthDate" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Marital Status:</span> <span id="detailMaritalStatus" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Spouse Name:</span> <span id="detailSpouseName" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Spouse's Contact:</span> <span id="detailSpouseContactNumber" class="detail-value"></span></div>
                    <div class="detail-group"><span class="detail-label">Wedding Anniversary:</span> <span id="detailWeddingAnniversary" class="detail-value"></span></div>
                    <div class="detail-group md:col-span-2"><span class="detail-label">Church Local Congregation:</span> <span id="detailChurchCongregation" class="detail-value"></span></div>
                    <div class="detail-group md:col-span-2">
                        <span class="detail-label">Children:</span>
                        <ul id="detailChildren" class="detail-value list-disc list-inside pl-4"></ul>
                    </div>
                </div>
                <div class="flex justify-center space-x-4 mt-8">
                    <button id="editVolunteerBtn" class="btn-primary text-sm px-4 py-2">Edit Volunteer</button>
                    <button id="deleteVolunteerBtn" class="btn-danger text-sm px-4 py-2">Delete Volunteer</button>
                    <button id="viewHistoryBtn" class="btn-secondary text-sm px-4 py-2">View Project History</button>
                </div>
            </div>
        </div>

        <!-- Attendance Monitoring Tab -->
        <div id="attendance" class="tab-content hidden">
            <h2 class="text-3xl font-semibold mb-6 text-gray-700">Attendance Monitoring</h2>

            <!-- New section for marking absent volunteers -->
            <div class="mb-6 p-6 bg-red-50 rounded-lg shadow-inner">
                <h3 class="text-2xl font-semibold mb-4 text-gray-700">Record Absent Volunteers</h3>
                <div id="absenteeInputContainer">
                    <!-- Initial absentee input fields will be added here by JavaScript -->
                </div>
                <div class="flex justify-end space-x-4 mt-4">
                    <button id="addAbsenteeFieldBtn" class="btn-secondary">Add Another Absentee</button>
                    <button id="recordAbsencesBtn" class="btn-danger">Record Absences</button>
                </div>
            </div>

            <h3 class="text-2xl font-semibold mb-4 text-gray-700">Attendance Records</h3>
            <div class="overflow-x-auto">
                <table class="table-auto">
                    <thead>
                        <tr>
                            <th>Volunteer Name</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Reason (if Absent)</th>
                        </tr>
                    </thead>
                    <tbody id="attendanceRecords">
                        <!-- Attendance records will be loaded here -->
                    </tbody>
                </table>
                <p id="noAttendanceRecords" class="text-center text-gray-600 mt-4 hidden">No attendance records found.</p>
            </div>
        </div>

        <!-- Task & Assignment Tab -->
        <div id="tasks" class="tab-content hidden">
            <h2 class="text-3xl font-semibold mb-6 text-gray-700">Task & Assignment Monitoring</h2>

            <div class="mb-6 text-center">
                <button id="importTasksBtn" class="btn-secondary">Import Tasks from Excel</button>
                <input type="file" id="taskExcelFileInput" class="hidden" accept=".xlsx, .xls, .csv">
            </div>

            <form id="taskForm" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 p-6 bg-yellow-50 rounded-lg shadow-inner">
                <input type="hidden" id="taskId">
                <div class="form-group">
                    <label for="taskVolunteerSelect">Assign To Volunteer:</label>
                    <select id="taskVolunteerSelect" class="mt-1" required>
                        <option value="">-- Select a Volunteer --</option>
                        <!-- Volunteer options will be loaded here -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="taskProject">Project:</label>
                    <input type="text" id="taskProject" class="mt-1" required>
                </div>
                <div class="form-group md:col-span-2">
                    <label for="taskArea">Area:</label>
                    <input type="text" id="taskArea" class="mt-1" required>
                </div>
                <div class="form-group md:col-span-2">
                    <label for="taskDescription">Task Description:</label>
                    <textarea id="taskDescription" rows="2" class="mt-1" required></textarea>
                </div>
                <div class="md:col-span-2 flex justify-end space-x-4">
                    <button type="submit" class="btn-primary">Save Task</button>
                    <button type="button" id="clearTaskForm" class="btn-secondary">Clear Form</button>
                </div>
            </form>

            <h3 class="text-2xl font-semibold mb-4 text-gray-700">Assigned Tasks</h3>
            <div class="overflow-x-auto">
                <table class="table-auto">
                    <thead>
                        <tr>
                            <th>Volunteer</th>
                            <th>Project</th>
                            <th>Area</th>
                            <th>Description</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="taskList">
                        <!-- Task data will be loaded here -->
                    </tbody>
                </table>
                <p id="noAssignedTasks" class="text-center text-gray-600 mt-4 hidden">No assigned tasks found.</p>
            </div>

            <!-- New section for Volunteers by Assigned Area -->
            <div class="mt-8 p-6 bg-blue-50 rounded-lg shadow-inner">
                <h3 class="text-2xl font-semibold mb-4 text-gray-700">Volunteers by Assigned Area</h3>
                <div id="volunteersByAreaContainer" class="space-y-4">
                    <!-- Dynamic list of volunteers by area will be generated here -->
                    <p class="text-center text-gray-600">Loading volunteers by area...</p>
                </div>
            </div>
        </div>

        <!-- Request Management Tab -->
        <div id="requests" class="tab-content hidden">
            <h2 class="text-3xl font-semibold mb-6 text-gray-700">Volunteer Request Management</h2>

            <div class="mb-6 p-6 bg-purple-50 rounded-lg shadow-inner">
                <h3 class="text-2xl font-semibold mb-4 text-gray-700">Submit New Request</h3>
                <form id="requestForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <input type="hidden" id="requestId">
                    <div class="form-group">
                        <label for="requestVolunteerIdentifier">Volunteer (Assigned No. or Name):</label>
                        <input type="text" id="requestVolunteerIdentifier" class="mt-1" placeholder="Enter assigned number or name" list="volunteerDatalist" required>
                        <datalist id="volunteerDatalist"></datalist>
                    </div>
                    <div class="form-group">
                        <label for="requestType">Request Type:</label>
                        <select id="requestType" class="mt-1" required>
                            <option value="">-- Select Request Type --</option>
                            <option value="Shift Change">Shift Change</option>
                            <option value="Leave Request">Leave Request</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group md:col-span-2">
                        <label for="requestDetails">Request Details:</label>
                        <textarea id="requestDetails" rows="3" class="mt-1" placeholder="Describe the request in detail" required></textarea>
                    </div>

                    <!-- Dates of Absence Section (conditionally displayed) -->
                    <div id="absenceDatesSection" class="md:col-span-2 hidden p-4 bg-purple-100 rounded-lg">
                        <h4 class="text-lg font-semibold mb-2 text-gray-700">Dates of Absence</h4>
                        <div id="absentDatesContainer" class="space-y-2">
                            <!-- Dynamic date input fields will be added here -->
                        </div>
                        <button type="button" id="addAbsentDateBtn" class="btn-secondary mt-3 px-4 py-2 text-sm">Add Another Date</button>
                    </div>

                    <div class="md:col-span-2 flex justify-end space-x-4 mt-4">
                        <button type="submit" class="btn-primary">Submit Request</button>
                        <button type="button" id="clearRequestForm" class="btn-secondary">Clear Request Form</button>
                    </div>
                </form>

                <div class="mt-8 p-4 bg-purple-100 rounded-lg">
                    <h4 class="text-lg font-semibold mb-2 text-gray-700">Volunteer Request Summary</h4>
                    <div class="form-group flex items-center space-x-2">
                        <label for="summaryVolunteerIdentifier" class="text-sm">Volunteer (Assigned No. or Name):</label>
                        <input type="text" id="summaryVolunteerIdentifier" class="flex-1 p-2 border rounded-md" placeholder="Enter assigned number or name" list="summaryVolunteerDatalist">
                        <datalist id="summaryVolunteerDatalist"></datalist>
                        <button id="showTotalRequestsBtn" class="btn-secondary px-3 py-2 text-sm">Show Total Requests</button>
                    </div>
                    <p id="totalRequestsDisplay" class="mt-2 text-lg font-medium text-gray-800">Total Requests for Volunteer: N/A</p>
                </div>
            </div>

            <h3 class="text-2xl font-semibold mb-4 text-gray-700">All Volunteer Requests</h3>
            <div class="overflow-x-auto">
                <table class="table-auto">
                    <thead>
                        <tr>
                            <th>Volunteer Name</th>
                            <th>Request Date</th>
                            <th>Type</th>
                            <th>Details</th>
                            <th>Absent Dates</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="requestList">
                        <!-- Request data will be loaded here -->
                    </tbody>
                </table>
                <p id="noRequestsFound" class="text-center text-gray-600 mt-4 hidden">No requests found.</p>
            </div>
        </div>

        <!-- Trade Reports Tab -->
        <div id="tradeReports" class="tab-content hidden">
            <h2 class="text-3xl font-semibold mb-6 text-gray-700">Volunteer Trade Reports</h2>

            <div class="mb-6 p-6 bg-green-50 rounded-lg shadow-inner">
                <h3 class="text-2xl font-semibold mb-4 text-gray-700">Volunteer Summary by Trade</h3>
                <div id="tradeSummary" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Summary will be dynamically inserted here -->
                </div>
                <p id="noTradeSummary" class="text-center text-gray-600 mt-4 hidden">No volunteers registered yet to generate trade summary.</p>
            </div>

            <h3 class="text-2xl font-semibold mb-4 text-gray-700">Volunteers by Selected Trade</h3>
            <div class="mb-4 flex items-center space-x-2">
                <label for="tradeFilterSelect" class="font-medium text-gray-700">Select Trade:</label>
                <select id="tradeFilterSelect" class="flex-1 p-2 border rounded-md">
                    <option value="">-- All Trades --</option>
                    <!-- Trades will be populated here -->
                </select>
            </div>
            <div class="overflow-x-auto">
                <table class="table-auto">
                    <thead>
                        <tr>
                            <th>Assigned No.</th>
                            <th>Full Name</th>
                            <th>Trade</th>
                            <th>Age</th>
                            <th>Address</th>
                        </tr>
                    </thead>
                    <tbody id="volunteersByTradeList">
                        <!-- Volunteers for selected trade will be loaded here -->
                    </tbody>
                </table>
                <p id="noVolunteersByTrade" class="text-center text-gray-600 mt-4 hidden">No volunteers found for this trade.</p>
            </div>
        </div>
        
        <div class="mt-12 text-center border-t pt-6 space-x-4">
             <button id="exportDataBtn" class="btn-secondary">Export All Data</button>
             <button id="importDataBtn" class="btn-secondary">Import All Data</button>
             <input type="file" id="importDataInput" class="hidden" accept=".json">
             <button id="deleteAllDataBtn" class="btn-danger">Delete All Data</button>
        </div>
    </div>

    <!-- Message Box for Confirmations/Alerts -->
    <div id="messageBoxOverlay" class="message-box-overlay hidden"></div>
    <div id="messageBox" class="message-box hidden">
        <h3 id="messageBoxTitle"></h3>
        <p id="messageBoxContent"></p>
        <div id="messageBoxButtons" class="flex justify-center">
            <button id="messageBoxConfirmBtn" class="btn-primary">OK</button>
            <button id="messageBoxCancelBtn" class="btn-secondary hidden">Cancel</button>
        </div>
    </div>

    <!-- Project History Modal -->
    <div id="projectHistoryModalOverlay" class="modal-overlay hidden"></div>
    <div id="projectHistoryModal" class="modal hidden">
        <h3 id="projectHistoryModalTitle"></h3>
        <div class="modal-content">
            <table class="table-auto">
                <thead>
                    <tr>
                        <th>Project</th>
                        <th>Area</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody id="projectHistoryList">
                    <!-- Project history data will be loaded here -->
                </tbody>
            </table>
        </div>
        <div class="flex justify-center mt-6">
            <button id="closeProjectHistoryModalBtn" class="btn-secondary">Close</button>
        </div>
    </div>
    
    <!-- Sheet Selection Modal -->
    <div id="sheetSelectionModalOverlay" class="modal-overlay hidden"></div>
    <div id="sheetSelectionModal" class="modal hidden">
        <h3>Select Excel Sheet</h3>
        <p>Please select the sheet you want to import:</p>
        <div id="sheetSelectionContainer" class="modal-content">
            <!-- Sheet options will be added here -->
        </div>
        <div class="flex justify-center mt-6">
            <button id="cancelSheetSelectionBtn" class="btn-secondary">Cancel</button>
        </div>
    </div>


    <!-- Excel Import Mapping Modal -->
    <div id="importMappingModalOverlay" class="modal-overlay hidden"></div>
    <div id="importMappingModal" class="modal hidden" style="max-width: 800px;">
        <h3>Map Excel Columns to Volunteer Fields</h3>
        <p>Please select the corresponding column from your Excel file for each required field. You can skip fields that are not in your file.</p>
        <div id="importMappingContainer" class="modal-content grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Mapping fields will be generated here by JavaScript -->
        </div>
        <div class="flex justify-center mt-6 space-x-4">
            <button id="processImportBtn" class="btn-primary">Process Import</button>
            <button id="cancelImportBtn" class="btn-secondary">Cancel</button>
        </div>
    </div>
    
    <!-- Task Import Mapping Modal -->
    <div id="taskImportMappingModalOverlay" class="modal-overlay hidden"></div>
    <div id="taskImportMappingModal" class="modal hidden" style="max-width: 800px;">
        <h3>Map Excel Columns to Task Fields</h3>
        <p>Please select the corresponding column from your Excel file for each required field.</p>
        <div id="taskImportMappingContainer" class="modal-content grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Mapping fields will be generated here by JavaScript -->
        </div>
        <div class="flex justify-center mt-6 space-x-4">
            <button id="processTaskImportBtn" class="btn-primary">Process Task Import</button>
            <button id="cancelTaskImportBtn" class="btn-secondary">Cancel</button>
        </div>
    </div>
    
    <!-- Duplicate Handling Modal -->
    <div id="duplicateModalOverlay" class="modal-overlay hidden"></div>
    <div id="duplicateModal" class="modal hidden" style="max-width: 900px;">
        <h3>Handle Duplicate Entries</h3>
        <p>The following volunteers (based on Assigned Number) already exist. Choose whether to update them with the new data or ignore the imported row.</p>
        <div id="duplicateListContainer" class="modal-content">
            <!-- Duplicate entries will be listed here -->
        </div>
        <div class="flex justify-center mt-6 space-x-4">
            <button id="confirmDuplicateChoicesBtn" class="btn-primary">Confirm Choices & Import</button>
            <button id="cancelDuplicateBtn" class="btn-secondary">Cancel Import</button>
        </div>
    </div>
    
    <!-- Final Delete Confirmation Modal -->
    <div id="finalDeleteModalOverlay" class="modal-overlay hidden"></div>
    <div id="finalDeleteModal" class="modal hidden">
        <h3>Final Confirmation</h3>
        <p>This action is irreversible. To confirm, please type "DELETE" in the box below.</p>
        <div class="form-group">
            <input type="text" id="deleteConfirmationInput" class="mt-1 text-center">
        </div>
        <div class="flex justify-center mt-6 space-x-4">
            <button id="finalDeleteBtn" class="btn-danger" disabled>Delete All Data</button>
            <button id="cancelFinalDeleteBtn" class="btn-secondary">Cancel</button>
        </div>
    </div>

    <script src="https://unpkg.com/heroicons@2.0.13/dist/heroicons.js"></script>
    <script src="wc_mgt.js"></script>
</body>
</html>
